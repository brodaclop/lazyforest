(this.webpackJsonpterkep=this.webpackJsonpterkep||[]).push([[0],{108:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(39),i=a.n(c),o=(a(98),a(25)),l=a(12),s=a(14),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))},d=function(e){var t=u([0,0],e);return[e[0]/t,e[1]/t]},h=function(e,t){return d([e[1]-t[1],t[0]-e[0]])},j=function(e,t){return[e[0]*t,e[1]*t]},b=function(e,t){return[e[0]+t[0],e[1]+t[1]]},g=function(e,t){return[e[0]-t[0],e[1]-t[1]]},v=function(e){return[-e[0],-e[1]]},f=function(e,t){return[Math.cos(t)*e,Math.sin(t)*e]},p=function(e,t){var a=g(e[1],e[0]),n=g(t[1],t[0]),r=g(e[0],t[0]),c=n[0]*r[1]-n[1]*r[0],i=a[0]*r[1]-a[1]*r[0],o=n[1]*a[0]-n[0]*a[1];if(0!==o){var l=c/o,s=i/o;if(0<=l&&l<=1&&0<=s&&s<=1)return l}return null};window.test=p;var O=function(e,t,a,n){var r=[e.canvas.width/a.size[0],e.canvas.height/a.size[1]],c=function(){e.setTransform(new DOMMatrix),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowColor="",e.shadowBlur=0,e.fillStyle="",e.strokeStyle="",e.scale.apply(e,r)},i=function(t){e.beginPath(),e.moveTo.apply(e,Object(s.a)(t[0])),t.slice(1).forEach((function(t){e.lineTo.apply(e,Object(s.a)(t))})),e.closePath()},o=function(r){var o;c();var l=t[r.texture];if(i(r.vertices),e.shadowColor="rgba(30, 30, 30, .5)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=null!==(o=a.edgeShade)&&void 0!==o?o:0,r.stretch){e.translate.apply(e,Object(s.a)(r.vertices[0]));var v=g(r.vertices[1],r.vertices[0]),f=u(v),p=u(g(r.vertices[2],r.vertices[1])),O=Math.atan2(v[1],v[0]);e.rotate(O);var m=[l.scale/l.loadedImage.width,l.scale/l.loadedImage.height];e.scale.apply(e,m),e.scale(f,p),e.scale(1.2,1.2),e.drawImage(l.loadedImage,-l.loadedImage.width/10,-l.loadedImage.height/10)}else{var x=[l.scale/l.loadedImage.width,l.scale/l.loadedImage.height];if(e.save(),e.scale.apply(e,x),e.fillStyle=e.createPattern(l.loadedImage,"repeat")||"#c0c",e.fill(),e.restore(),r.edge){var y=t[r.edge.texture],w=[y.scale/y.loadedImage.width,y.scale/y.loadedImage.height];i(function(e){for(var t=[],a=0;a<e.vertices.length;a++){var n,r,c=e.vertices[(a+e.vertices.length-1)%e.vertices.length],i=e.vertices[a],o=e.vertices[(a+1)%e.vertices.length],l=h(i,o),s=h(c,i),u=d(b(l,s));t.push(b(i,j(u,null!==(n=null===(r=e.edge)||void 0===r?void 0:r.width[0])&&void 0!==n?n:0)))}for(var g=e.vertices.length-1;g>=0;g--){var v,f,p=e.vertices[(g+e.vertices.length-1)%e.vertices.length],O=e.vertices[g],m=e.vertices[(g+1)%e.vertices.length],x=h(O,m),y=h(p,O),w=d(b(x,y));t.push(b(O,j(w,null!==(v=null===(f=e.edge)||void 0===f?void 0:f.width[1])&&void 0!==v?v:0)))}return t.splice(e.vertices.length,0,t[0],t[t.length-1]),t}(r)),e.scale.apply(e,w),e.fillStyle=e.createPattern(y.loadedImage,"repeat")||"#c0c",e.fill()}}n&&(e.strokeStyle="rgba(255, 255, 0, 1)",e.lineWidth=20,e.stroke())},l=function(a,i){var o;c();var l=t[a.texture];e.moveTo.apply(e,Object(s.a)(a.origin)),e.translate.apply(e,Object(s.a)(a.origin));var u=[l.scale/l.loadedImage.naturalWidth,l.scale/l.loadedImage.naturalHeight];e.scale.apply(e,u);var d=j(i,null!==(o=a.height)&&void 0!==o?o:0);e.shadowColor="rgba(30, 30, 30, .8)",e.shadowOffsetX=d[0],e.shadowOffsetY=d[1],e.shadowBlur=2,e.drawImage(l.loadedImage,-l.loadedImage.naturalWidth/2,-l.loadedImage.naturalHeight/2),n&&(e.shadowOffsetX=0,e.shadowOffsetY=0,function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#0ff";c(),e.beginPath(),e.moveTo.apply(e,Object(s.a)(t)),e.strokeStyle=a,e.fillStyle=a,e.arc.apply(e,Object(s.a)(t).concat([2/r[0],0,2*Math.PI])),e.fill(),e.closePath()}(a.origin),e.arc.apply(e,Object(s.a)(a.origin).concat([a.radius,0,2*Math.PI])),e.fillStyle="rgba(255, 0, 0, .5)",e.fill())},v=function(){e.clearRect(0,0,e.canvas.width,e.canvas.height),console.log(a),Object.values(a.layers).forEach((function(e){var t,n;null===(t=e.areas)||void 0===t||t.sort((function(e,t){return(e.stretch?1:0)-(t.stretch?1:0)})).forEach(o),null===(n=e.objects)||void 0===n||n.sort((function(e,t){return e.height-t.height})).forEach((function(e){return l(e,a.shadowVector)}))})),a.tint&&"none"!==a.tint&&(c(),e.fillStyle=a.tint,e.setTransform(new DOMMatrix),e.fillRect(0,0,e.canvas.width,e.canvas.height)),c(),e.setTransform(new DOMMatrix),e.beginPath();for(var t=0;t<a.size[0];t++)e.moveTo(r[0]*t,0),e.lineTo(r[0]*t,e.canvas.height);for(var n=0;n<a.size[1];n++)e.moveTo(0,n*r[1]),e.lineTo(e.canvas.width,n*r[1]);e.strokeStyle="black",e.lineWidth=1,e.stroke()};v()},m=function(e){return Math.floor(Math.random()*e)},x=function(e,t){return e+Math.random()*(t-e)},y=function(e,t){var a=x(.2,.8),n=u(e,t);if(n<.01)return null;var r,c=function(e,t){return[t[0]-e[0],t[1]-e[1]]}(e,t),i=b(e,j(c,a)),o=h(e,t),l=j(o,x(-(r=.1*n),r));return b(i,l)},w=function(e,t,a,n){var r=j(h(e,t),a/2),c=[e,t],i=c.map((function(e){return b(e,v(r))})),o=c.reverse().map((function(e){return b(e,r)}));return{vertices:[].concat(Object(s.a)(i),Object(s.a)(o)),texture:n,stretch:!0}},C=function e(t,a,n,r,c,i){var o=j(h(t,a),n/2),l=[t,a];if(i&&c){var u=function(e,t){for(var a=[],n=0;n<t.vertices.length;n++){var r=t.vertices[n],c=t.vertices[(n+1)%t.vertices.length],i=p(e,[r,c]);null!==i&&a.push(i)}return a}(l,i);if(u.sort((function(e,t){return e-t})),2===u.length){var d=b(t,j(g(a,t),u[0])),f=b(t,j(g(a,t),u[1]));return[].concat(Object(s.a)(e(t,d,n,r)),Object(s.a)(e(f,a,n,r)),[w(d,f,n,c)])}}for(var O=0;O<1e3;O++){var x=m(l.length-1)+1,C=y(l[x-1],l[x]);C&&l.splice(x,0,C)}var k=l.map((function(e){return b(e,v(o))})),S=l.reverse().map((function(e){return b(e,o)}));return[{vertices:[].concat(Object(s.a)(k),Object(s.a)(S)),texture:r}]},k=function(e,t,a,n){if(e.length>2){var r=e.reduce((function(t,a){return[t[0]+a.from[0]/e.length,t[1]+a.from[1]/e.length]}),[0,0]);return e.flatMap((function(e){return C(e.from,r,e.width,t,a,n)}))}return C(e[0].from,e[1].from,e[0].width,t,a,n)},S=function(e,t,a,n){for(var r=0,c=function(){var n=[x(0,e[0]),x(0,e[1])];if(t.every((function(e){return u(e.origin,n)>a+e.radius})))return{v:n}};r++<n;){var i=c();if("object"===typeof i)return i.v}return null},I=function(e,t,a,n,r,c){for(var i=[],o=0;o<a;o++){var l=S(e,i.concat(t),r,1e3);if(null===l){console.warn("stopped object generation at ".concat(o,", too many tries"));break}i.push({origin:l,orientation:x(0,2*Math.PI),height:n,radius:r,texture:c})}return i},M=function(e){var t=new OffscreenCanvas(1,1).getContext("2d"),a=new Path2D;return a.moveTo.apply(a,Object(s.a)(e.vertices[0])),e.vertices.slice(1).forEach((function(e){a.lineTo.apply(a,Object(s.a)(e))})),a.closePath(),function(e){return t.isPointInPath.apply(t,[a].concat(Object(s.a)(e)))}},P=function(e,t,a,n,r,c){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],o=i.map(M);return I(e,t,a,n,r,c).filter((function(e){return o.every((function(t){return!t(e.origin)}))}))},R=function(e){var t=m(4),a=e[t%2],n=x(.1*a,.9*a);switch(t){case 0:return[n,-2];case 1:return[e[0]+2,n];case 2:return[n,e[1]+2];case 3:return[-2,n];default:throw new Error("randomInt(4) returned a weird value")}},T=function(e,t){return{layers:{base:{areas:[{vertices:[[0,0],[e[0],0],e,[0,e[1]]],texture:t}],type:"base"}},shadowVector:[0,0],size:e}},F=function(e,t,a,n,r,c,i){var o=e.size,l=[{from:[x(.1*o[0],.9*o[0]),-2],width:a},{from:[x(.1*o[0],.9*o[0]),o[1]+2],width:a}];return e.layers[t]={areas:k(l,n.name).map((function(e){return r&&(c||i)&&(e.edge={texture:r.name,width:[-a*i/200,a*c/200]}),e})),type:"river"},e},E=function(e,t,a,n,r,c,i,o,l,u){var d=e.size,h=[{from:[-2,x(.1*d[1],.9*d[1])],width:a},{from:[d[0]+2,x(.1*d[1],.9*d[1])],width:a}],j=n.map((function(e){return{from:R(d),width:e}}));return e.layers[t]={areas:k([].concat(h,Object(s.a)(j)),r.name,null===c||void 0===c?void 0:c.name,i).map((function(e){return o&&(l||u)&&(e.edge={texture:o.name,width:[-a*u/200,a*l/200]}),e})),type:"road"},e},z=function(e,t,a,n){var r,c,i,o,l=null!==(r=null===(c=e.layers[t])||void 0===c?void 0:c.objects)&&void 0!==r?r:[],u=[].concat(Object(s.a)(null!==(i=e.layers.road.areas)&&void 0!==i?i:[]),Object(s.a)(null!==(o=e.layers.river.areas)&&void 0!==o?o:[])),d=P(e.size,l,a,n.height,n.radius,n.name,u);return e.layers[t]={objects:l.concat(d),type:"object"},e},L=a(55),V=a.n(L),W=a(78),B=a.p+"static/media/gravel.fadd9e77.jpg",D=a.p+"static/media/grass.1bdb8368.jpg",H=a.p+"static/media/tree.251e1382.png",A=a.p+"static/media/tree2.b70d7e22.png",N=a.p+"static/media/rock.f8863753.png",X=a.p+"static/media/dirtroad.3f84b32a.jpg",Y=a.p+"static/media/lightergrass.775fd4e3.jpg",J=a.p+"static/media/water.5bcc6117.jpg",U=a.p+"static/media/bridge.01e94610.png",q=a.p+"static/media/bridge2.c503a7ba.png",G=a.p+"static/media/soil.9c952be7.jpg",K=a.p+"static/media/moss.7486eee9.jpg",Q=a.p+"static/media/snow.cdc2b6b3.jpg",Z=a.p+"static/media/coarse-snow.b9df7fb0.jpg",$=a.p+"static/media/ice.6cad5e0a.jpg",_=a(1),ee={sunset:"rgba(230,120,0,0.15)",evening:"rgba(0,0,250,0.2)",night:"rgba(0,0,250,0.3)"},te=[{name:"water",url:J,type:"pattern",scale:1,category:"river",height:0,radius:0},{name:"ice",url:$,type:"pattern",scale:2,category:"river",height:0,radius:0},{name:"bridge",url:U,type:"pattern",scale:1,category:"bridge",height:0,radius:0},{name:"straight bridge",url:q,type:"pattern",scale:1,category:"bridge",height:0,radius:0},{name:"gravel",url:B,type:"pattern",scale:1,category:"road",height:0,radius:0},{name:"dirt",url:X,type:"pattern",scale:1,category:"road",height:0,radius:0},{name:"grass",url:D,type:"pattern",scale:3,category:"ground",height:0,radius:0},{name:"snow",url:Q,type:"pattern",scale:3,category:"ground",height:0,radius:0},{name:"snow bank",url:Z,type:"pattern",scale:.7,category:"road-edge",height:0,radius:0,alphaMultiplier:.7},{name:"lighter grass",url:Y,type:"pattern",scale:1,category:"ground",height:0,radius:0},{name:"soil",url:G,type:"pattern",scale:1,category:"river-edge",height:0,radius:0,alphaMultiplier:.7},{name:"moss",url:K,type:"pattern",scale:1,category:"road-edge",height:0,radius:0,alphaMultiplier:.3},{name:"tree",url:H,type:"single",scale:2,category:"tree",height:8,radius:1},{name:"bigtree",url:H,type:"single",scale:4,category:"tree",height:16,radius:2},{name:"other tree",url:A,type:"single",scale:3,category:"tree",height:12,radius:1.5},{name:"rock",url:N,type:"single",scale:.3,category:"rock",height:2,radius:.25}],ae=function(){var e=Object(W.a)(V.a.mark((function e(t,a){var n,r,c,i,o,l;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=new OffscreenCanvas(t.naturalWidth,t.naturalHeight),(r=n.getContext("2d")).drawImage(t,0,0),c=r.getImageData(0,0,t.naturalWidth,t.naturalHeight),i=3;i<c.data.length;i+=4)c.data.set([c.data[i]*a],i);return r.putImageData(c,0,0),o=new Image,e.next=9,n.convertToBlob({type:"image/png"});case 9:return l=e.sent,o.src=URL.createObjectURL(l),e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ne=function(e){var t=e.onLoaded,a=Object(n.useReducer)((function(e,t){return e+1}),0),r=Object(l.a)(a,2),c=r[0],i=r[1];return Object(n.useEffect)((function(){c===te.length&&Object(W.a)(V.a.mark((function e(){var a,n,r,c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=0;case 2:if(!(n<te.length)){e.next=14;break}if(r=te[n],c=document.getElementById(r.name),void 0===r.alphaMultiplier){e.next=10;break}return e.next=8,ae(c,r.alphaMultiplier);case 8:c=e.sent,console.log(c);case 10:a.push(Object(o.a)(Object(o.a)({},r),{},{loadedImage:c}));case 11:n++,e.next=2;break;case 14:t(a);case 15:case"end":return e.stop()}}),e)})))()}),[c,t]),Object(_.jsx)(_.Fragment,{children:te.map((function(e){return Object(_.jsx)("img",{src:e.url,id:e.name,style:{display:"none"},alt:"",onLoad:i},e.name)}))})},re=a(152),ce=a(153),ie=a(154),oe=a(167),le=a(148),se=a(158),ue=a(169),de=a(170),he=a(171),je=a(182),be=function(e){var t=e.title,a=e.enabled,n=e.blocks,r=e.titleContent;return Object(_.jsxs)(se.a,{disabled:!a,children:[Object(_.jsx)(ue.a,{expandIcon:Object(_.jsx)(le.a,{}),children:Object(_.jsxs)(de.a,{children:[t," ",r]})}),Object(_.jsx)(he.a,{children:n.map((function(e){return Object(_.jsxs)(je.a,{sx:{m:1},children:[e.title&&Object(_.jsx)(de.a,{children:e.title}),Object(_.jsx)(je.a,{sx:{borderTop:e.title?1:0,pt:e.title?1:0},children:e.content})]})}))})]})},ge=a(172),ve=a(159),fe=function(e){var t=e.value,a=e.min,n=e.max,r=e.step,c=e.label,i=e.width,o=void 0===i?90:i,l=e.onChange;return Object(_.jsx)(ge.a,{sx:{width:"".concat(o,"%")},label:c,labelPlacement:"top",control:Object(_.jsx)(ve.a,{value:t,valueLabelDisplay:"auto",min:a,max:n,step:r,marks:!!r,onChange:function(e,t){return l(t)}})})},pe=a(173),Oe=a(162),me=a(156),xe=a(160),ye=function(e){var t=e.textures,a=e.type,n=e.category,r=e.label,c=e.value,i=e.width,o=void 0===i?90:i,l=e.onChange,s=function(e){return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("img",{alt:"Texture: ".concat(e),style:{height:"1.5rem",marginRight:"0.2rem"},src:t[e].url}),e]})};return Object(_.jsxs)(pe.a,{sx:{width:"".concat(o,"%")},children:[Object(_.jsx)(Oe.a,{children:r}),Object(_.jsxs)(me.a,{value:c,onChange:function(e){return l(e.target.value)},label:r,displayEmpty:!0,renderValue:function(e){return e?s(e):r},autoWidth:!0,children:[Object(_.jsx)(xe.a,{value:"",children:"None"}),Object.keys(t).filter((function(e){return t[e].type===a})).filter((function(e){return!n||t[e].category===n})).map((function(e){return Object(_.jsx)(xe.a,{value:e,children:s(e)})}))]})]})},we=function(e){var t=e.name,a=e.textures,r=e.generateObjects,c=e.clearLayer,i=e.deleteLayer,o=Object(n.useState)(0),s=Object(l.a)(o,2),u=s[0],d=s[1],h=Object(n.useState)(""),j=Object(l.a)(h,2),b=j[0],g=j[1];return Object(_.jsx)(be,{title:"Layer: ".concat(t),enabled:!0,titleContent:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(oe.a,{startIcon:Object(_.jsx)(re.a,{}),disabled:0===u||""===b,onClick:function(e){r(u,b),e.stopPropagation()},children:"Add"}),Object(_.jsx)(oe.a,{startIcon:Object(_.jsx)(ce.a,{}),onClick:function(e){c(),e.stopPropagation()},children:"Clear"}),Object(_.jsx)(oe.a,{startIcon:Object(_.jsx)(ie.a,{}),onClick:function(e){i(),e.stopPropagation()},children:"Remove"})]}),blocks:[{content:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe,{width:40,label:"No. of objects:",value:u,step:1,min:0,max:100,onChange:d}),Object(_.jsx)(ye,{width:40,label:"Object texture",value:b,textures:null!==a&&void 0!==a?a:{},type:"single",onChange:g})]})}]})},Ce=a(163),ke=a(177),Se=function(e){var t=e.layers,a=e.onCreate,r=Object(n.useState)(""),c=Object(l.a)(r,2),i=c[0],o=c[1];return Object(_.jsx)(se.a,{onClick:function(e){return e.stopPropagation()},children:Object(_.jsx)(ue.a,{children:Object(_.jsx)(de.a,{children:Object(_.jsx)(Ce.a,{variant:"standard",size:"small",label:"Add object layer",value:i,onChange:function(e){return o(e.target.value)},InputProps:{endAdornment:Object(_.jsx)(ke.a,{position:"end",children:Object(_.jsx)(oe.a,{startIcon:Object(_.jsx)(re.a,{}),disabled:""===i||t.includes(i),onClick:function(){a(i),o("")},children:"Create"})})}})})})})},Ie=a(174),Me=a(161),Pe=a(178),Re=a(84),Te=function(e){var t=e.items,a=e.itemFactory,n=e.addItem,r=e.removeItem,c=e.name;return Object(_.jsxs)(Ie.a,{children:[Object(Re.range)(0,t).map((function(e){return Object(_.jsxs)(Me.a,{children:[a(e)," ",Object(_.jsx)(Pe.a,{onClick:function(){return r(e)},children:Object(_.jsx)(ie.a,{})})]})})),Object(_.jsx)(Me.a,{children:Object(_.jsx)(oe.a,{startIcon:Object(_.jsx)(re.a,{}),onClick:n,children:"Add ".concat(c)})})]})},Fe=function(e){e.name;var t=e.textures,a=e.generateRoads,r=e.sceneHasRiver,c=Object(n.useState)(0),i=Object(l.a)(c,2),o=i[0],u=i[1],d=Object(n.useState)(""),h=Object(l.a)(d,2),j=h[0],b=h[1],g=Object(n.useState)(""),v=Object(l.a)(g,2),f=v[0],p=v[1],O=Object(n.useState)([]),m=Object(l.a)(O,2),x=m[0],y=m[1],w=Object(n.useState)(""),C=Object(l.a)(w,2),k=C[0],S=C[1],I=Object(n.useState)(0),M=Object(l.a)(I,2),P=M[0],R=M[1],T=Object(n.useState)(0),F=Object(l.a)(T,2),E=F[0],z=F[1];return Object(_.jsx)(be,{title:"Roads",enabled:!0,titleContent:Object(_.jsx)(oe.a,{disabled:""===j,onClick:function(e){a(o,x,j,f,k,P,E),e.stopPropagation()},children:"Regenerate"}),blocks:[{content:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe,{width:30,label:"Main road width",value:o,min:0,max:10,step:.1,onChange:u}),Object(_.jsx)(ye,{width:30,value:j,label:"Road texture",textures:null!==t&&void 0!==t?t:{},category:"road",type:"pattern",onChange:b}),r&&Object(_.jsx)(ye,{width:30,value:f,label:"Bridge texture",textures:null!==t&&void 0!==t?t:{},category:"bridge",type:"pattern",onChange:p})]})},{title:"Side roads",content:Object(_.jsx)(Te,{items:x.length,name:"side road",addItem:function(){y([].concat(Object(s.a)(x),[0]))},removeItem:function(e){x.splice(e,1),y(Object(s.a)(x))},itemFactory:function(e){return Object(_.jsx)(fe,{label:"Side road width:",value:x[e],min:0,max:10,step:.1,onChange:function(t){x[e]=t,y(Object(s.a)(x))}})}})},{title:"Verge",content:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe,{width:25,label:"Verge width %",value:P,min:0,max:100,step:1,onChange:R}),Object(_.jsx)(fe,{width:25,label:"Verge overhang %",value:E,min:0,max:100,step:1,onChange:z}),Object(_.jsx)(ye,{width:30,value:k,textures:null!==t&&void 0!==t?t:{},type:"pattern",category:"road-edge",onChange:S,label:"Verge texture"})]})}]})},Ee=function(e){var t=e.tint,a=e.shadowVector,n=e.onShadowChange,r=e.onTintChange,c=e.resolution,i=e.onResolutionChange,o=e.edgeShade,l=e.onEdgeShadeChange,s=Math.round(10*u(a)),d=Math.round(180*Math.atan2(a[1],a[0])/Math.PI);return Object(_.jsx)(be,{title:"Visual tweaks",enabled:!0,blocks:[{content:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe,{width:25,label:"Edge shade",min:0,max:300,step:5,value:o,onChange:l}),Object(_.jsxs)(me.a,{sx:{width:"25%"},value:t||"none",onChange:function(e){return r(e.target.value)},children:[Object(_.jsx)(xe.a,{value:"none",children:"no tint"}),Object.keys(ee).map((function(e){return Object(_.jsx)(xe.a,{value:ee[e],children:e})}))]}),Object(_.jsx)(fe,{label:"Pixels per grid",width:35,min:20,max:100,step:5,value:c,onChange:i})]})},{title:"Shadows",content:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe,{width:40,label:"Shadow length",value:s,min:0,max:50,step:1,onChange:function(e){return n(f(e/10,Number(d)*Math.PI/180))}}),Object(_.jsx)(fe,{width:40,label:"Shadow direction",step:5,min:-180,max:180,value:d,onChange:function(e){return n(f(s/10,e*Math.PI/180))}})]})}]})},ze=function(e){var t=e.textures,a=e.createScene,r=Object(n.useState)(""),c=Object(l.a)(r,2),i=c[0],o=c[1],s=Object(n.useState)(10),u=Object(l.a)(s,2),d=u[0],h=u[1],j=Object(n.useState)(10),b=Object(l.a)(j,2),g=b[0],v=b[1];return Object(_.jsx)(be,{title:"Scene (".concat(d," x ").concat(g,")"),titleContent:Object(_.jsx)(oe.a,{disabled:""===i,onClick:function(e){a([d,g],i),e.stopPropagation()},children:"Create"}),enabled:!0,blocks:[{title:"Background",content:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe,{width:25,value:d,min:1,max:50,step:1,onChange:h,label:"Width"}),Object(_.jsx)(fe,{width:25,value:g,min:1,max:50,step:1,onChange:v,label:"Height"}),Object(_.jsx)(ye,{width:30,value:i,textures:null!==t&&void 0!==t?t:{},type:"pattern",category:"ground",onChange:o,label:"Ground texture"})]})}]})},Le=function(e){e.name;var t=e.textures,a=e.generateRiver,r=Object(n.useState)(0),c=Object(l.a)(r,2),i=c[0],o=c[1],s=Object(n.useState)(""),u=Object(l.a)(s,2),d=u[0],h=u[1],j=Object(n.useState)(""),b=Object(l.a)(j,2),g=b[0],v=b[1],f=Object(n.useState)(0),p=Object(l.a)(f,2),O=p[0],m=p[1],x=Object(n.useState)(0),y=Object(l.a)(x,2),w=y[0],C=y[1];return Object(_.jsx)(be,{title:"River",enabled:!0,titleContent:Object(_.jsx)(oe.a,{disabled:""===d,onClick:function(e){a(i,d,g,O,w),e.stopPropagation()},children:"Regenerate"}),blocks:[{content:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe,{width:40,label:"Width",value:i,min:0,max:10,step:.1,onChange:o}),Object(_.jsx)(ye,{width:40,value:d,textures:null!==t&&void 0!==t?t:{},type:"pattern",category:"river",onChange:h,label:"River texture"})]})},{title:"Riverbank",content:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(fe,{width:25,label:"Width %",value:O,min:0,max:100,step:1,onChange:m}),Object(_.jsx)(fe,{width:25,label:"Overhang %",value:w,min:0,max:100,step:1,onChange:C}),Object(_.jsx)(ye,{width:30,value:g,textures:null!==t&&void 0!==t?t:{},type:"pattern",category:"river-edge",onChange:v,label:"Texture"})]})}]})},Ve=a(155),We=a(179),Be=a(180),De=a(164),He=function(){var e,t,a=Object(n.useRef)(null),r=Object(n.useState)(),c=Object(l.a)(r,2),i=c[0],s=c[1],u=Object(n.useState)(T([10,10],"grass")),d=Object(l.a)(u,2),h=d[0],j=d[1],b=Object(n.useState)(70),g=Object(l.a)(b,2),v=g[0],f=g[1],p=Object(n.useState)(!1),m=Object(l.a)(p,2),x=m[0],y=m[1],w=Object(n.useCallback)((function(e,t,a,n,r,c,l,s){var u,d;i&&j(Object(o.a)({},E(h,e,t,a,i[n],i[r],null===(u=h.layers.river)||void 0===u||null===(d=u.areas)||void 0===d?void 0:d[0],i[c],l,s)))}),[h,i]),C=Object(n.useCallback)((function(e,t,a,n,r,c){i&&j(Object(o.a)({},F(h,e,t,i[a],i[n],r,c)))}),[h,i]),k=Object(n.useCallback)((function(e){var t,a,n,r;null===(t=h.layers)||void 0===t||(null===(a=t[e])||void 0===a||delete a.areas),null===(n=h.layers)||void 0===n||(null===(r=n[e])||void 0===r||delete r.objects),j(Object(o.a)({},h))}),[h]),S=Object(n.useCallback)((function(e){var t;null===(t=h.layers)||void 0===t||delete t[e],j(Object(o.a)({},h))}),[h]),I=Object(n.useCallback)((function(e){h.layers[e]={type:"object"},j(Object(o.a)({},h))}),[h]),M=Object(n.useCallback)((function(e,t,a){i&&z(h,e,t,i[a]),j(Object(o.a)({},h))}),[h,i]),P=Object(n.useCallback)((function(e,t){j(T(e,t))}),[]);Object(n.useEffect)((function(){if(i){var e=a.current;if(e){var t=e.getContext("2d");t&&O(t,i,h,x)}}}),[i,h,v,x]);var R=Object(n.useCallback)((function(e){var t=e.reduce((function(e,t){return e[t.name]=t,e}),{});s(t)}),[]);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ne,{onLoaded:R}),Object(_.jsxs)("div",{style:{display:"flex",width:"100%"},children:[Object(_.jsxs)(Ve.a,{spacing:1,children:[Object(_.jsx)(ze,{textures:null!==i&&void 0!==i?i:{},createScene:P}),Object(_.jsx)(Le,{name:"river",textures:null!==i&&void 0!==i?i:{},generateRiver:C.bind(null,"river")}),Object(_.jsx)(Fe,{name:"road",sceneHasRiver:!!h.layers.river,textures:null!==i&&void 0!==i?i:{},generateRoads:w.bind(null,"road")}),Object.keys(h.layers).filter((function(e){return"object"===h.layers[e].type})).map((function(e){return Object(_.jsx)(we,{name:e,textures:null!==i&&void 0!==i?i:{},generateObjects:function(t,a){return M(e,t,a)},clearLayer:function(){return k(e)},deleteLayer:function(){return S(e)}})})),h.layers.road&&Object(_.jsx)(Se,{layers:Object.keys(h.layers),onCreate:I}),Object(_.jsx)(Ee,{tint:null!==(e=h.tint)&&void 0!==e?e:"",shadowVector:h.shadowVector,onShadowChange:function(e){h.shadowVector=e,j(Object(o.a)({},h))},onTintChange:function(e){h.tint=e,j(Object(o.a)({},h))},resolution:v,onResolutionChange:f,edgeShade:null!==(t=h.edgeShade)&&void 0!==t?t:0,onEdgeShadeChange:function(e){h.edgeShade=Math.max(0,e),j(Object(o.a)({},h))}}),Object(_.jsx)(We.a,{children:Object(_.jsx)(Be.a,{children:Object(_.jsx)(ge.a,{control:Object(_.jsx)(De.a,{checked:x,onChange:function(){return y(!x)}}),label:"Debug mode"})})})]}),Object(_.jsx)("canvas",{style:{width:"".concat(h.size[0]*v,"px"),height:"".concat(h.size[1]*v,"px")},ref:a,width:"".concat(h.size[0]*v,"px"),height:"".concat(h.size[1]*v,"px")})]})]})};var Ae=function(){return Object(_.jsx)("div",{className:"App",children:Object(_.jsx)(He,{})})},Ne=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,183)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))};i.a.render(Object(_.jsx)(r.a.StrictMode,{children:Object(_.jsx)(Ae,{})}),document.getElementById("root")),Ne()},98:function(e,t,a){}},[[108,1,2]]]);
//# sourceMappingURL=main.69ce5d93.chunk.js.map