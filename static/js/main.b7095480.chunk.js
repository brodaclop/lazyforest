(this.webpackJsonpterkep=this.webpackJsonpterkep||[]).push([[0],{139:function(e,t,a){},149:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(50),i=a.n(c),o=(a(139),a(22)),s=a(12),u=a(11),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))},d=function(e){var t=l([0,0],e);return[e[0]/t,e[1]/t]},j=function(e,t){return d([e[1]-t[1],t[0]-e[0]])},b=function(e,t){return[e[0]*t,e[1]*t]},h=function(e,t){return[e[0]+t[0],e[1]+t[1]]},g=function(e,t){return[e[0]-t[0],e[1]-t[1]]},v=function(e){return[-e[0],-e[1]]},f=function(e,t){return[Math.cos(t)*e,Math.sin(t)*e]},O=function(e,t){var a=g(e[1],e[0]),n=g(t[1],t[0]),r=g(e[0],t[0]),c=n[0]*r[1]-n[1]*r[0],i=a[0]*r[1]-a[1]*r[0],o=n[1]*a[0]-n[0]*a[1];if(0!==o){var s=c/o,u=i/o;if(0<=s&&s<=1&&0<=u&&u<=1)return s}return null};window.test=O;var p=function(e,t,a,n){var r=[e.canvas.width/a.size[0],e.canvas.height/a.size[1]],c=function(){e.setTransform(new DOMMatrix),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowColor="",e.shadowBlur=0,e.fillStyle="",e.strokeStyle="",e.scale.apply(e,r)},i=function(t){e.beginPath(),e.moveTo.apply(e,Object(u.a)(t[0])),t.slice(1).forEach((function(t){e.lineTo.apply(e,Object(u.a)(t))})),e.closePath()},o=function(r){var o,s;c();var v=t[r.texture.name];i(r.vertices),e.shadowColor="rgba(30, 30, 30, .9)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=null!==(o=a.edgeShade)&&void 0!==o?o:0,e.rotate(null!==(s=r.texture.rotate)&&void 0!==s?s:0);var f=v.scale*(r.texture.scale||1);if(r.stretch){e.translate.apply(e,Object(u.a)(r.vertices[0]));var O=g(r.vertices[1],r.vertices[0]),p=l(O),m=l(g(r.vertices[2],r.vertices[1])),x=Math.atan2(O[1],O[0]);e.rotate(x);var y=[f/v.loadedImage.width,f/v.loadedImage.height];e.scale.apply(e,y),e.scale(p,m),e.scale(1.2,1.2),e.drawImage(v.loadedImage,-v.loadedImage.width/10,-v.loadedImage.height/10)}else{var w=[f/v.loadedImage.width,f/v.loadedImage.height];e.save(),e.scale.apply(e,w),e.fillStyle=e.createPattern(v.loadedImage,"repeat")||"#c0c",e.fill(),e.restore(),i(function(e,t){for(var a=[],n=0;n<e.vertices.length;n++){var r=e.vertices[(n+e.vertices.length-1)%e.vertices.length],c=e.vertices[n],i=e.vertices[(n+1)%e.vertices.length],o=j(c,i),s=j(r,c),l=d(h(o,s));a.push(h(c,b(l,t)))}var g=Object(u.a)(e.vertices);return[].concat(a,[a[0],e.vertices[0]],Object(u.a)(g.reverse()))}(r,-.05)),e.scale.apply(e,w),e.fillStyle=e.createPattern(v.transparentImage,"repeat")||"#c0c",e.fill()}n&&(e.strokeStyle="rgba(255, 255, 0, 1)",e.lineWidth=20,e.stroke())},s=function(a,i){var o,s;c();var l=t[a.texture.name],d=l.scale*(a.texture.scale||1);e.moveTo.apply(e,Object(u.a)(a.origin)),e.translate.apply(e,Object(u.a)(a.origin)),e.rotate((null!==(o=a.texture.rotate)&&void 0!==o?o:0)+a.orientation);var j=[d/l.loadedImage.naturalWidth,d/l.loadedImage.naturalHeight];e.scale.apply(e,j);var h=b(i,null!==(s=a.height)&&void 0!==s?s:0);e.shadowColor="rgba(30, 30, 30, .9)",e.shadowOffsetX=h[0],e.shadowOffsetY=h[1],e.shadowBlur=2,e.drawImage(l.loadedImage,-l.loadedImage.naturalWidth/2,-l.loadedImage.naturalHeight/2),n&&(e.shadowOffsetX=0,e.shadowOffsetY=0,function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#0ff";c(),e.beginPath(),e.moveTo.apply(e,Object(u.a)(t)),e.strokeStyle=a,e.fillStyle=a,e.arc.apply(e,Object(u.a)(t).concat([2/r[0],0,2*Math.PI])),e.fill(),e.closePath()}(a.origin),e.arc.apply(e,Object(u.a)(a.origin).concat([a.radius,0,2*Math.PI])),e.fillStyle="rgba(255, 0, 0, .2)",e.fill())},v=function(){e.clearRect(0,0,e.canvas.width,e.canvas.height),console.log(a),Object.values(a.layers).forEach((function(e){var t,n;null===(t=e.areas)||void 0===t||t.sort((function(e,t){return(e.stretch?1:0)-(t.stretch?1:0)})).forEach(o),null===(n=e.objects)||void 0===n||n.forEach((function(e){return s(e,a.shadowVector)}))})),a.tint&&"none"!==a.tint&&(c(),e.fillStyle=a.tint,e.setTransform(new DOMMatrix),e.fillRect(0,0,e.canvas.width,e.canvas.height)),c(),e.setTransform(new DOMMatrix),e.beginPath();for(var t=0;t<a.size[0];t++)e.moveTo(r[0]*t,0),e.lineTo(r[0]*t,e.canvas.height);for(var n=0;n<a.size[1];n++)e.moveTo(0,n*r[1]),e.lineTo(e.canvas.width,n*r[1]);e.strokeStyle="black",e.lineWidth=1,e.stroke()};v()},m=function(e){return Math.floor(Math.random()*e)},x=function(e,t){return e+Math.random()*(t-e)},y=function(e,t){var a=x(.2,.8),n=l(e,t);if(n<.01)return null;var r,c=function(e,t){return[t[0]-e[0],t[1]-e[1]]}(e,t),i=h(e,b(c,a)),o=j(e,t),s=b(o,x(-(r=.1*n),r));return h(i,s)},w=function(e,t,a,n){var r=b(j(e,t),a/2),c=[e,t],i=c.map((function(e){return h(e,v(r))})),o=c.reverse().map((function(e){return h(e,r)}));return{vertices:[].concat(Object(u.a)(i),Object(u.a)(o)),texture:n,stretch:!0}},C=function e(t,a,n,r,c,i){var o=b(j(t,a),n/2),s=[t,a];if(i&&c){var l=function(e,t){for(var a=[],n=0;n<t.vertices.length;n++){var r=t.vertices[n],c=t.vertices[(n+1)%t.vertices.length],i=O(e,[r,c]);null!==i&&a.push(i)}return a}(s,i);if(l.sort((function(e,t){return e-t})),2===l.length){var d=h(t,b(g(a,t),l[0])),f=h(t,b(g(a,t),l[1]));return[].concat(Object(u.a)(e(t,d,n,r)),Object(u.a)(e(f,a,n,r)),[w(d,f,n,c)])}}for(var p=0;p<1e3;p++){var x=m(s.length-1)+1,C=y(s[x-1],s[x]);C&&s.splice(x,0,C)}var k=s.map((function(e){return h(e,v(o))})),S=s.reverse().map((function(e){return h(e,o)}));return[{vertices:[].concat(Object(u.a)(k),Object(u.a)(S)),texture:r}]},k=function(e,t,a,n){if(e.length>2){var r=e.reduce((function(t,a){return[t[0]+a.from[0]/e.length,t[1]+a.from[1]/e.length]}),[0,0]);return e.flatMap((function(e){return C(e.from,r,e.width,t,a,n)}))}return C(e[0].from,e[1].from,e[0].width,t,a,n)},S=function(e,t,a,n){for(var r=0,c=function(){var n=[x(0,e[0]),x(0,e[1])];if(t.every((function(e){return l(e.origin,n)>a+e.radius})))return{v:n}};r++<n;){var i=c();if("object"===typeof i)return i.v}return null},I=function(e,t,a,n,r,c){for(var i=[],o=0;o<a;o++){var s=S(e,i.concat(t),r,1e3);if(null===s){console.warn("stopped object generation at ".concat(o,", too many tries"));break}i.push({origin:s,orientation:x(0,2*Math.PI),height:n,radius:r,texture:c})}return i},M=function(e){var t=new OffscreenCanvas(1,1).getContext("2d"),a=new Path2D;return a.moveTo.apply(a,Object(u.a)(e.vertices[0])),e.vertices.slice(1).forEach((function(e){a.lineTo.apply(a,Object(u.a)(e))})),a.closePath(),function(e){return t.isPointInPath.apply(t,[a].concat(Object(u.a)(e)))}},P=function(e,t,a,n,r,c){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],o=i.map(M);return I(e,t,a,n,r,c).filter((function(e){return o.every((function(t){return!t(e.origin)}))}))},R=function(e){var t=m(4),a=e[t%2],n=x(.1*a,.9*a);switch(t){case 0:return[n,-2];case 1:return[e[0]+2,n];case 2:return[n,e[1]+2];case 3:return[-2,n];default:throw new Error("randomInt(4) returned a weird value")}},T=function(e,t){return{layers:{base:{areas:[{vertices:[[0,0],[e[0],0],e,[0,e[1]]],texture:{name:t}}],type:"base"}},shadowVector:[0,0],size:e}},L=function(e,t,a,n){var r=e.size,c=[{from:[x(.1*r[0],.9*r[0]),-2],width:a},{from:[x(.1*r[0],.9*r[0]),r[1]+2],width:a}];return e.layers[t]={areas:k(c,{name:n.name}),type:"river"},e},E=function(e,t,a,n,r,c,i){var o=e.size,s=[{from:[-2,x(.1*o[1],.9*o[1])],width:a},{from:[o[0]+2,x(.1*o[1],.9*o[1])],width:a}],l=n.map((function(e){return{from:R(o),width:e}})),d=c&&{name:c.name};return e.layers[t]={areas:k([].concat(s,Object(u.a)(l)),{name:r.name},d,i),type:"road"},e},H=function(e,t,a,n){var r,c,i,o,s=null!==(r=null===(c=e.layers[t])||void 0===c?void 0:c.objects)&&void 0!==r?r:[],l=[].concat(Object(u.a)(null!==(i=e.layers.road.areas)&&void 0!==i?i:[]),Object(u.a)(null!==(o=e.layers.river.areas)&&void 0!==o?o:[])),d=P(e.size,s,a,n.height,n.radius,{name:n.name},l);return e.layers[t]={objects:s.concat(d),type:"object"},e},N=a(77),z=a.n(N),A=a(111),D=a.p+"static/media/gravel.fadd9e77.jpg",F=a.p+"static/media/grass.1bdb8368.jpg",B=a.p+"static/media/tree.251e1382.png",V=a.p+"static/media/tree2.b70d7e22.png",W=a.p+"static/media/rock.f8863753.png",X=a.p+"static/media/dirtroad.3f84b32a.jpg",Y=a.p+"static/media/lightergrass.775fd4e3.jpg",G=a.p+"static/media/water.5bcc6117.jpg",J=a.p+"static/media/bridge.01e94610.png",U=a.p+"static/media/bridge2.c503a7ba.png",q=a(2),K={sunset:"rgba(230,120,0,0.15)",evening:"rgba(0,0,250,0.2)",night:"rgba(0,0,250,0.3)"},Q=[{name:"water",url:G,type:"pattern",scale:1,category:"river",height:0,radius:0},{name:"bridge",url:J,type:"pattern",scale:1,category:"bridge",height:0,radius:0},{name:"straight bridge",url:U,type:"pattern",scale:1,category:"bridge",height:0,radius:0},{name:"gravel",url:D,type:"pattern",scale:1,category:"road",height:0,radius:0},{name:"dirt",url:X,type:"pattern",scale:1,category:"road",height:0,radius:0},{name:"grass",url:F,type:"pattern",scale:3,category:"ground",height:0,radius:0},{name:"lighter grass",url:Y,type:"pattern",scale:1,category:"ground",height:0,radius:0},{name:"tree",url:B,type:"single",scale:2,category:"tree",height:8,radius:1},{name:"bigtree",url:B,type:"single",scale:4,category:"tree",height:16,radius:2},{name:"other tree",url:V,type:"single",scale:3,category:"tree",height:12,radius:1.5},{name:"rock",url:W,type:"single",scale:.3,category:"rock",height:2,radius:.25}],Z=function(){var e=Object(A.a)(z.a.mark((function e(t){var a,n,r,c,i,o;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new OffscreenCanvas(t.naturalWidth,t.naturalHeight),(n=a.getContext("2d")).drawImage(t,0,0),r=n.getImageData(0,0,t.naturalWidth,t.naturalHeight),c=3;c<r.data.length;c+=4)3===c&&console.log("alpha",t.src,r.data[c]),r.data.set([r.data[c]/3],c);return n.putImageData(r,0,0),i=new Image,e.next=9,a.convertToBlob({type:"image/png"});case 9:return o=e.sent,i.src=URL.createObjectURL(o),e.abrupt("return",i);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(e){var t=e.onLoaded,a=Object(n.useReducer)((function(e,t){return e+1}),0),r=Object(s.a)(a,2),c=r[0],i=r[1];return Object(n.useEffect)((function(){c===Q.length&&Object(A.a)(z.a.mark((function e(){var a,n,r,c,i;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=0;case 2:if(!(n<Q.length)){e.next=12;break}return r=Q[n],c=document.getElementById(r.name),e.next=7,Z(c);case 7:i=e.sent,a.push(Object(o.a)(Object(o.a)({},r),{},{loadedImage:c,transparentImage:i}));case 9:n++,e.next=2;break;case 12:t(a);case 13:case"end":return e.stop()}}),e)})))()}),[c,t]),Object(q.jsx)(q.Fragment,{children:Q.map((function(e){return Object(q.jsx)("img",{src:e.url,id:e.name,style:{display:"none"},alt:"",onLoad:i},e.name)}))})},_=a(163),ee=a(165),te=a(160),ae=a(122),ne=a(113),re=a(161),ce=function(e){var t=e.textures,a=e.type,n=e.category,r=e.value,c=e.onChange;return Object(q.jsx)(re.a,{value:r,onChange:function(e,t){var a=t.value;return c(a)},placeholder:"Select texture",options:Object.keys(t).filter((function(e){return t[e].type===a})).filter((function(e){return!n||t[e].category===n})).map((function(e){return{key:e,text:e,value:e,image:t[e].url}}))})},ie=function(e){var t=e.name,a=e.textures,r=e.generateObjects,c=e.clearLayer,i=e.deleteLayer,o=Object(n.useState)(0),u=Object(s.a)(o,2),l=u[0],d=u[1],j=Object(n.useState)(""),b=Object(s.a)(j,2),h=b[0],g=b[1];return Object(q.jsxs)(_.a,{children:[Object(q.jsx)(_.a.Header,{children:Object(q.jsxs)(ee.a,{textAlign:"center",children:["Object layer: ",t]})}),Object(q.jsxs)(_.a.Content,{children:[Object(q.jsx)(te.a,{type:"number",label:"No. of objects:",value:l,step:1,onChange:function(e){return d(Number(e.target.value))}}),Object(q.jsx)(ce,{value:h,textures:null!==a&&void 0!==a?a:{},type:"single",onChange:g}),Object(q.jsxs)(ae.a,{children:[Object(q.jsx)(ne.a,{content:"Add",icon:"plus",disabled:0===l||""===h,onClick:function(){return r(l,h)}}),Object(q.jsx)(ne.a,{content:"Clear",icon:"eraser",onClick:c}),Object(q.jsx)(ne.a,{content:"Remove",icon:"remove",onClick:i})]})]})]})},oe=function(e){var t=e.layers,a=e.onCreate,r=Object(n.useState)(""),c=Object(s.a)(r,2),i=c[0],o=c[1];return Object(q.jsxs)(_.a,{children:[Object(q.jsx)(_.a.Header,{children:Object(q.jsx)(ee.a,{textAlign:"center",children:"Add new layer"})}),Object(q.jsxs)(_.a.Content,{children:[Object(q.jsx)(te.a,{label:"Layer name",value:i,onChange:function(e){return o(e.target.value)}}),Object(q.jsx)(ne.a,{icon:"clone outline",content:"Create",disabled:""===i||t.includes(i),onClick:function(){a(i),o("")}})]})]})},se=a(123),ue=a(162),le=function(e){var t=e.items,a=e.itemFactory,n=e.addItem,r=e.removeItem,c=e.itemIcon,i=e.name;return Object(q.jsxs)(ue.a,{divided:!0,relaxed:!0,children:[Object(se.range)(0,t).map((function(e){return Object(q.jsxs)(ue.a.Item,{children:[c&&Object(q.jsx)(ue.a.Icon,{name:c}),Object(q.jsxs)(ue.a.Content,{children:[a(e)," ",Object(q.jsx)(ne.a,{floated:"right",icon:"remove",onClick:function(){return r(e)}})]})]})})),Object(q.jsx)(ue.a.Item,{children:Object(q.jsx)(ue.a.Content,{children:Object(q.jsx)(ne.a,{icon:"plus",content:"Add ".concat(i),onClick:n})})})]})},de=function(e){e.name;var t=e.textures,a=e.generateRoads,r=e.sceneHasRiver,c=Object(n.useState)(0),i=Object(s.a)(c,2),o=i[0],l=i[1],d=Object(n.useState)(""),j=Object(s.a)(d,2),b=j[0],h=j[1],g=Object(n.useState)(""),v=Object(s.a)(g,2),f=v[0],O=v[1],p=Object(n.useState)([]),m=Object(s.a)(p,2),x=m[0],y=m[1];return Object(q.jsxs)(_.a,{children:[Object(q.jsx)(_.a.Header,{children:Object(q.jsx)(ee.a,{textAlign:"center",children:"Road Layer"})}),Object(q.jsxs)(_.a.Content,{children:[Object(q.jsx)(te.a,{label:"Main road width:",type:"number",value:o,onChange:function(e){return l(Number(e.target.value))}}),Object(q.jsx)(ce,{value:b,textures:null!==t&&void 0!==t?t:{},category:"road",type:"pattern",onChange:h}),r&&Object(q.jsx)(ce,{value:f,textures:null!==t&&void 0!==t?t:{},category:"bridge",type:"pattern",onChange:O}),Object(q.jsx)(le,{items:x.length,name:"side road",itemIcon:"road",addItem:function(){y([].concat(Object(u.a)(x),[0]))},removeItem:function(e){x.splice(e,1),y(Object(u.a)(x))},itemFactory:function(e){return Object(q.jsx)(te.a,{label:"Side road width:",type:"number",value:x[e],onChange:function(t){x[e]=Number(t.target.value),y(Object(u.a)(x))}})}}),Object(q.jsx)(ne.a,{icon:"redo",content:"Generate",disabled:""===b,onClick:function(){return a(o,x,b,f)}})]})]})},je=a(166),be=function(e){var t=e.tint,a=e.shadowVector,n=e.onShadowChange,r=e.onTintChange,c=e.resolution,i=e.onResolutionChange,o=e.edgeShade,s=e.onEdgeShadeChange,d=Math.round(10*l(a)),j=Math.round(180*Math.atan2(a[1],a[0])/Math.PI);return Object(q.jsxs)(_.a,{children:[Object(q.jsx)(_.a.Header,{children:Object(q.jsx)(ee.a,{textAlign:"center",children:"Visual tweaks"})}),Object(q.jsxs)(_.a.Content,{children:[Object(q.jsx)(re.a,{value:t||"none",onChange:function(e,t){var a=t.value;return r(a)},options:[{key:"",value:"none",text:"no tint"}].concat(Object(u.a)(Object.keys(K).map((function(e){return{key:e,value:K[e],text:e}}))))}),Object(q.jsx)("br",{}),Object(q.jsx)(te.a,{label:"Shadow length",type:"number",value:d,onChange:function(e){return n(f(Number(e.target.value)/10,Number(j)*Math.PI/180))}}),Object(q.jsx)(te.a,{label:"Shadow direction",type:"number",step:5,value:j,onChange:function(e){return n(f(d/10,Number(e.target.value)*Math.PI/180))}}),Object(q.jsx)(te.a,{label:"Edge shade",type:"number",step:5,value:o,onChange:function(e){return s(Number(e.target.value))}}),Object(q.jsx)(te.a,{label:"Pixels per grid",type:"number",step:5,value:c,onChange:function(e){return i(Number(e.target.value))}})]})]})},he=function(e){var t=e.textures,a=e.createScene,r=Object(n.useState)(""),c=Object(s.a)(r,2),i=c[0],o=c[1],u=Object(n.useState)(10),l=Object(s.a)(u,2),d=l[0],j=l[1],b=Object(n.useState)(10),h=Object(s.a)(b,2),g=h[0],v=h[1];return Object(q.jsxs)(_.a,{children:[Object(q.jsx)(_.a.Header,{children:Object(q.jsx)(ee.a,{textAlign:"center",children:"Scene"})}),Object(q.jsxs)(_.a.Content,{children:[Object(q.jsx)(te.a,{type:"number",label:"Width",value:d,step:20,onChange:function(e){return j(Number(e.target.value))}}),Object(q.jsx)(te.a,{type:"number",label:"Height",value:g,step:20,onChange:function(e){return v(Number(e.target.value))}}),Object(q.jsx)(ce,{value:i,textures:null!==t&&void 0!==t?t:{},type:"pattern",category:"ground",onChange:o}),Object(q.jsx)(ne.a,{icon:"clone outline",content:"Create",disabled:""===i,onClick:function(){return a([d,g],i)}})]})]})},ge=function(e){e.name;var t=e.textures,a=e.generateRiver,r=Object(n.useState)(0),c=Object(s.a)(r,2),i=c[0],o=c[1],u=Object(n.useState)(""),l=Object(s.a)(u,2),d=l[0],j=l[1];return Object(q.jsxs)(_.a,{children:[Object(q.jsx)(_.a.Header,{children:Object(q.jsx)(ee.a,{textAlign:"center",children:"River Layer"})}),Object(q.jsxs)(_.a.Content,{children:[Object(q.jsx)(te.a,{label:"River width:",type:"number",value:i,onChange:function(e){return o(Number(e.target.value))}}),Object(q.jsx)(ce,{value:d,textures:null!==t&&void 0!==t?t:{},category:"river",type:"pattern",onChange:j}),Object(q.jsx)(ne.a,{icon:"redo",content:"Generate",disabled:""===d,onClick:function(){return a(i,d)}})]})]})},ve=function(){var e,t=Object(n.useRef)(null),a=Object(n.useState)(),r=Object(s.a)(a,2),c=r[0],i=r[1],u=Object(n.useState)(T([10,10],"grass")),l=Object(s.a)(u,2),d=l[0],j=l[1],b=Object(n.useState)(70),h=Object(s.a)(b,2),g=h[0],v=h[1],f=Object(n.useState)(!1),O=Object(s.a)(f,2),m=O[0],x=O[1],y=Object(n.useCallback)((function(e,t,a,n,r){var i,s;c&&j(Object(o.a)({},E(d,e,t,a,c[n],c[null!==r&&void 0!==r?r:""],null===(i=d.layers.river)||void 0===i||null===(s=i.areas)||void 0===s?void 0:s[0])))}),[d,c]),w=Object(n.useCallback)((function(e,t,a){c&&j(Object(o.a)({},L(d,e,t,c[a])))}),[d,c]),C=Object(n.useCallback)((function(e){var t,a,n,r;null===(t=d.layers)||void 0===t||(null===(a=t[e])||void 0===a||delete a.areas),null===(n=d.layers)||void 0===n||(null===(r=n[e])||void 0===r||delete r.objects),j(Object(o.a)({},d))}),[d]),k=Object(n.useCallback)((function(e){var t;null===(t=d.layers)||void 0===t||delete t[e],j(Object(o.a)({},d))}),[d]),S=Object(n.useCallback)((function(e){d.layers[e]={type:"object"},j(Object(o.a)({},d))}),[d]),I=Object(n.useCallback)((function(e,t,a){c&&H(d,e,t,c[a]),j(Object(o.a)({},d))}),[d,c]),M=Object(n.useCallback)((function(e,t){j(T(e,t))}),[]);Object(n.useEffect)((function(){if(c){var e=t.current;if(e){var a=e.getContext("2d");a&&p(a,c,d,m)}}}),[c,d,g,m]);var P=Object(n.useCallback)((function(e){var t=e.reduce((function(e,t){return e[t.name]=t,e}),{});i(t)}),[]);return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)($,{onLoaded:P}),Object(q.jsxs)("div",{style:{display:"flex"},children:[Object(q.jsx)("div",{children:Object(q.jsxs)(_.a.Group,{itemsPerRow:1,children:[Object(q.jsx)(he,{textures:null!==c&&void 0!==c?c:{},createScene:M}),Object(q.jsx)(ge,{name:"river",textures:null!==c&&void 0!==c?c:{},generateRiver:w.bind(null,"river")}),Object(q.jsx)(de,{name:"road",sceneHasRiver:!!d.layers.river,textures:null!==c&&void 0!==c?c:{},generateRoads:y.bind(null,"road")}),Object.keys(d.layers).filter((function(e){return"object"===d.layers[e].type})).map((function(e){return Object(q.jsx)(ie,{name:e,textures:null!==c&&void 0!==c?c:{},generateObjects:function(t,a){return I(e,t,a)},clearLayer:function(){return C(e)},deleteLayer:function(){return k(e)}})})),d.layers.road&&Object(q.jsx)(oe,{layers:Object.keys(d.layers),onCreate:S}),Object(q.jsx)(be,{tint:null!==(e=d.tint)&&void 0!==e?e:"",shadowVector:d.shadowVector,onShadowChange:function(e){d.shadowVector=e,j(Object(o.a)({},d))},onTintChange:function(e){d.tint=e,j(Object(o.a)({},d))},resolution:g,onResolutionChange:v,edgeShade:d.edgeShade,onEdgeShadeChange:function(e){d.edgeShade=Math.max(0,e),j(Object(o.a)({},d))}}),Object(q.jsx)(_.a,{children:Object(q.jsx)(_.a.Content,{children:Object(q.jsx)(je.a,{label:"Debug mode",checked:m,onChange:function(e,t){return x(!m)},toggle:!0})})})]})}),Object(q.jsx)("canvas",{style:{width:"".concat(d.size[0]*g,"px"),height:"".concat(d.size[1]*g,"px")},ref:t,width:"".concat(d.size[0]*g,"px"),height:"".concat(d.size[1]*g,"px")})]})]})};a(148);var fe=function(){return Object(q.jsx)("div",{className:"App",children:Object(q.jsx)(ve,{})})},Oe=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,167)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))};i.a.render(Object(q.jsx)(r.a.StrictMode,{children:Object(q.jsx)(fe,{})}),document.getElementById("root")),Oe()}},[[149,1,2]]]);
//# sourceMappingURL=main.b7095480.chunk.js.map